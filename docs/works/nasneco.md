---
layout: default
title: "自動作曲bot 「茄子ねこ」"
date: 2020-3-12
---

## 概要

茄子ねこ（@nasneco）に成り代わって作曲したり、呟いたりするTwitter botです。

 ![profile](https://nakashimas.github.io/img/nasneco/profile.png "profile")

[Twitterアカウント(@cc_99_ff) >](https://twitter.com/cc_99_ff)

## 機能

このbotの主な機能は以下の三点です。（改修中の機能は停止しています。）

- 文章の投稿
- 楽曲の投稿
- 楽曲生成依頼に対する楽曲の投稿（改修中）

加えて、Twitterアカウント自体の機能として、次のようなこともします。

- フォローを返す

なお、広告系アカウント、スパムアカウントはフォローを返さない場合があります。

## 稼働状況

<div style="text-align:center;">
    <a class="twitter-timeline" data-width="320" data-height="400" data-chrome="transparent nofooter" data-link-color="#ff8080" href="https://twitter.com/cc_99_ff?ref_src=twsrc%5Etfw">
        Tweets by cc_99_ff
    </a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

## 使用方法

*改修のめどがついたため、説明を差し替えました。*

### 楽曲生成依頼

botに対してリプライを送ることによって、楽曲生成を依頼することができます。  
生成された楽曲は、依頼主に対する動画付きのリプライで返されます。

依頼文の構成は以下の通りです。

```sh
@cc_99_ff music;
```

### 楽曲生成オプションの構成

#### 構成の概要

旋律の要件に応じて、オプションが指定できます。  
オプションの記述方法は、[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)に準拠しており、ABC楽譜の表現の一部を共有しています。  
構成は以下の通りです。

```sh
@cc_99_ff music?[header]?[body];
```

headerおよびbodyは、それぞれABC曲の曲ヘッダ（情報フィールド）、曲本体（音楽コード）を保持し、区切り文字「?」によって区別されます。  
（従って、各要素に「?」を値として含めることはできません。）

#### 曲ヘッダ

曲ヘッダの各要素（T：曲タイトル、M：拍子、など）は、「[key]="[value]"」の構成で表現され、headerおよびbodyと同じく、区切り文字「?」を用いて複数の要素の定義が可能です。

```sh
@cc_99_ff music?[key]="[value]"?[key]="[value]";
```

例えば、タイトルが「FugueA-dur」である、bpmが110で4/4拍子の曲を表現する場合、以下のように記述します。

```sh
@cc_99_ff music?T="FugueA-dur"?Q="1/4=110"?M="4/4";
```

[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)と比べて、記述に注意が必要な項目は、[オプションの各要素-曲ヘッダの情報](####曲ヘッダの情報)を参照してください。

#### 曲本体

上記の構成の中で、曲ヘッダの構文に当てはまらないものは、曲本体として扱われます。  
曲本体は、いくつかの小節線と音符、その他の装飾で表現されます。  
楽譜の各要素の記述方法は、[オプションの各要素-曲本体の情報](####曲本体の情報)を参照してください。

#### 具体例

以下に記入の具体例を示します。

```sh
@cc_99_ff music?T="hoge"?L="1/8"?E|:D2B2d2(3:2:3BBB|[1D2B2d2(3:2:3BBB:|[2A2A2A2(3:2:3BBB|];
```

### オプションの各要素

#### 曲ヘッダの情報

- Tオプション

Tオプションは曲のタイトルを定義します。  
タイトルは空白がエスケープされ、左詰めになります。  
Tオプションが指定されなかった場合のデフォルト値は、「No Title」となります。

- Cオプション

Cオプションは作曲者名を定義します。  
作曲者名は空白がエスケープされ、左詰めになります。  
Cオプションが指定されなかった場合のデフォルト値は、「Unknown」となります。

- Mオプション

Mオプションは拍子を定義します。  
拍子は[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記が利用可能です。  
Mオプションが指定されなかった場合のデフォルト値は、「4/4」です。

- Lオプション

Lオプションは音符の長さの基準値を定義します。  
長さの基準値は全音符を「1/1」とした分数で表現し、「[fraction]」と記述します。  
Lオプションが指定されなかった場合のデフォルト値は、[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の標準の推定方法に則り、定義されます。

上記より、Mオプションのデフォルト値は「4/4」であるため、曲ヘッダに何も記載していない場合のLオプションのデフォルト値は「1/8」（八分音符）です。

- Qオプション

Qオプションはテンポ(：bpm)を定義します。  
[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)でサポートされている標準の表現「[fractions] = [counts]」は、bpmとしての表記「1/4 = [counts]」のみサポートしています。  
仮にその他の表記が用いられている場合にも、「1/4 = [counts]」と記載されている前提で処理されることに注意してください。

また、以下の速度記号が含まれる場合、対応するbpmの代表値が割り当てられます。

| 表記 | bpm |
| :---- | ----: |
| Adagio | 60 |
| Allegro | 140 |
| Andante | 80 |
| Largo | 50 |
| Moderato | 100 |
| Presto | 180 |

Qオプションが指定されなかった場合のデフォルト値は、「1/4 = 120」です。

- その他のオプション

上記以外のオプションも設定可能ですが、現在、出力に全く影響しません。

#### 曲本体の情報

- 小節線

小節線は[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記が利用可能です。  
具体的には、以下の7種類の表現方法があります。

| 表記 | 名前 |
| :---- | ----: |
| \| | 小節線 |
| \|\| | 複縦線 |
| :\| | 繰り返し記号<br>終点 |
| \|: | 繰り返し記号<br>始点 |
| :: | 繰り返し記号<br>終点と始点 |
| \|] | 終止線 |
| [\| | 謎の記号 |

- 繰り返しの基準点

繰り返しの基準点は[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記が利用可能です。  
具体的には、以下の2種類の表現方法があります。

| 表記 | 名前 | 表記箇所 |
| :---- | ----: | ----: |
| [1 | 1番括弧 | 小節の冒頭 |
| [2 | 2番括弧 | 小節の冒頭 |

- 長さ

長さは[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記が利用可能です。  
具体的には、長さの基準値Lを「1」とした分数で表現し、音程表記の後に「[fraction]」と記述します。なお、「1/2」は「/」と省略可能です。  
また、「///」が「/8」に等しいように、論理的な拡張が可能です。  

長さの表記は、楽典に則る楽譜の表記に縛られず、限りなく0に近いものから、非常に大きな値、複雑な付点音符なども表現可能です。  
しかし、結果としてtwitterの動画の長さ制限140秒を超える長さや、midiの最小分解能480に満たない長さは、出力に影響を与えません。

- 連符

連符は[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記が利用可能です。  
具体的には、適応させる音符群の、音程表記及び臨時記号類の前に、「([counts]」と記述します。  
また、拡張的な表現として、「([counts p]:[counts q]:[counts r]」がサポートされています。pはp連符であることを、qは長さの基準値Lを1とした場合の分割前の長さを、rは適応させる個数を指定します。なお、p以外の数値は省略可能です。

- ブロークン・リズム

ブロークン・リズムは[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記が利用可能です。  
具体的には、二つの音符の表記の間に「>」あるいは「<」を記述します。  

[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の標準では、「>」は区切られた前の音符と後の音符の長さの比が3:1であることを表し、「<」はその逆を表すと説明されていますが、  
[『EasyABC』](https://www.nilsliberg.se/ksp/easyabc/)の挙動に準拠して、「>」は区切られた前の音符の長さを3/2倍に、後の音符の長さを1/2倍にし、「<」はその逆を表す表現として扱われることに注意してください。

- 臨時記号類

臨時記号類は[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記が利用可能です。  
具体的には、以下の5種類の表現方法があります。  

| 表記 | 名前 | 表記箇所 |
| :---- | ----: | ----: |
| _ | フラット | 音程の前 |
| ^ | シャープ | 音程の前 |
| = | ナチュラル | 音程の前 |
| ' | 1オクターブ上 | 音程の後 |
| , | 1オクターブ下 | 音程の後 |

また、「^^」がダブルシャープを表すように、論理的な拡張が可能で、楽典に則る表記を逸脱する表現も可能です。（例えば「^_^c,,」は「^c,,」に等しい。）  

一方で、小節内の臨時記号の効果の保続はなく、親切臨時記号の表記が必ず必要であることに注意してください。

- 音程

音程は[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記が利用可能です。  
具体的には、中央ハ(midi 60, 88鍵盤の24個目の白鍵, C4)をCとして、順にD(midi 62), E(midi 64), F(midi 65), G(midi 67), A(midi 69), B(midi 71)と表現し、小文字で表記することで1オクターブ上を表します。  
加えて、上記の臨時記号類の変化を受け付け、[標準MIDIファイル](https://ja.m.wikipedia.org/wiki/スタンダードMIDIファイル)が表現可能なpitch、0~127に対応する音程が表現可能です。（対応する文字列は「C,,,,,」~「g'''」）

- 装飾音符

装飾音符（アッチャカトゥーラ及びアポジャトゥーラ）は現在サポートしておらず、[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)の表記「{[notes]}」もしくは「{/[notes]}」で表された部分は全てエスケープされます。

- その他

その他の[ABC記譜法](https://ja.m.wikipedia.org/wiki/ABC記譜法)でサポートしている表記で、現在botがサポートしていない表現は、トリル等の装飾を含め、複数存在します。  
そのような表現の該当箇所は殆どがエスケープされますが、一部表記はエラーメッセージが返されます。

## 投稿内容の扱い、及び利用上の注意

### 説明

このbotの文章の投稿は、他のTwitterユーザーの投稿から独自に収集したデータと、MCMCによって生成しています。  
また、楽曲の投稿は、開発者が選んだ著作権保護期間が終了したピアノ独奏曲と、茄子ねこ（@nasneco）の楽曲から生成しています。  

### 責任

万一、このbotの投稿及びシステムが損害を発生させた場合には、理由の如何にかかわらず、管理者及び開発者は保証をせず、また、一切の責任を負いません。  

### 管理

投稿内容は、ある程度制御が可能です。そのため、投稿内容に権利侵害や、不適切な内容があれば、下記のお問い合わせ先までご連絡ください。管理者及び開発者の判断により、なるべく修正いたしまします。あるいは、管理者の判断により、指定された投稿の削除を行います。

## お問い合わせ

以下のような内容で、管理者及び開発者にお問い合わせされる場合は、本サイトの[「Form」](#infoform)からフォームにメッセージを送信してください。返信が必要な方は、「e-mail」の項目にメールアドレスを記載してください。  

- 投稿の削除要請
- このbotや、本サイトに関するメッセージ
- 改善点
- 質問
- 開発への参加

## 近況

（2020/04/08）　楽曲生成機能の改良をしました。  
（2020/03/19）　動画投稿機能の修正をしました。  
（2020/03/17）　フォローを返すようにしました。  
（2020/03/16）　文章を投稿するようにしました。  
（2019/10/24）　稼働を一時止めました。  
（2019/10/12）　楽曲投稿を始めました。  

## 改修予定

楽曲生成依頼機能の修正、楽曲生成機能のlinux対応、その他マイナーチェンジ

## 質問に対する回答

まだ質問はありません

<hr>

[Home >](https://nakashimas.github.io/index.html)  
[Works >](https://nakashimas.github.io/docs/works/works.html)