{{ define "main" }}
    {{ partial "hero/hero.html" . }}

    {{$pages := (where $.Site.RegularPages "Type" "article")}}
    {{$first_page := 2}}
    {{$line_counts := 10}}
    {{ range $index, $page := $pages}}
        {{$line_num := add (mod $index $line_counts) 1}}
        {{$line_num_string := string $line_num}}
        {{$page_num := add (div (sub $index (mod $index $line_counts)) $line_counts) $first_page}}
        {{$page_num_string := string $page_num}}

        {{$data_content_length := index .Site.Params.main.data_content_length (sub $page_num $first_page)}}
        {{$data_navigation_length := index .Site.Params.main.data_navigation_length (sub $page_num $first_page)}}

        {{if eq (mod $index $line_counts) 0}}
            {{printf "<article id='page-%[1]s' class='h-100 w-100 bg-dark' data-content-length='%[2]s' data-navigation-length='%[3]s'>" $page_num_string $data_content_length $data_navigation_length | safeHTML }}
        {{ end }}
        
        {{if le ($line_num) (div $line_counts 2)}}
            {{ "<!-- left line -->" | safeHTML }}
            {{printf "<div class='line line-x line-%[1]s line-%[1]s-%[2]s length-1 line-hidden' onclick='toggleShow(this)'>" "left" $line_num_string | safeHTML }}
        {{ else }}
            {{ "<!-- right line -->" | safeHTML }}
            {{$new_line_num := string (sub (add $line_num 1) (div $line_counts 2))}}
            {{printf "<div class='line line-x line-%[1]s line-%[1]s-%[2]s length-1 line-hidden' onclick='toggleShow(this)'>" "right" $new_line_num | safeHTML }}
        {{ end }}

        <div class="bg-light">
            <div class="container-title">
                <h2>{{ .Title }}</h2>
                <span>{{ delimit .Params.category ", " }}</span>
            </div>
            <div class="container-content">
                {{ .Content }}
            </div>
            <div class="container-ribbon bg-light h-100">
            </div>
        </div>
        
        {{printf "</div>" | safeHTML }}

        {{if eq (mod $index $line_counts) (sub $line_counts 1)}}
            {{printf "</article>" | safeHTML }}
        {{ end }}
        
        {{if and (eq $index (sub (len $pages) 1)) (lt (mod $index $line_counts) (sub $line_counts 1))}}
            {{printf "</article>" | safeHTML }}
        {{ end }}
    {{ end }}

    {{ partial "portfolio/portfolio.html" . }}
{{ end }}